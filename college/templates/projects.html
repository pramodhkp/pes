{% extends "dashboard.html" %}

{% load disqus_tags %}
{% disqus_dev %}
<title> Projects </title>
{% block content %}

<div class="container">
<h2 class="text-center">{{ project.name }}</h2>

<h3> Details: </h3>
<hr/>

<p> {{ project.details }} </p>

<h3> Project mentors: </h3>
<hr/>

<ul>
{% for teachers in project.members_t.all %}
<li>{{ teachers.first_name }} {{ teachers.last_name }}</li>
{% endfor %}
</ul>

<h3>Students working under this:</h3>
<hr>

<ul>
{% for students in project.members_s.all %}
<li>{{ students.first_name }} {{ students.last_name }}</li>
{% endfor %}
</ul>

<h3>Project evaluation summary </h3>
<hr/>

<div class="row">
  <div class="col-lg-11">
    <div class="panel panel-primary">
      <div class="panel-heading">
        <h3 class="panel-title"><i class="fa fa-bar-chart-o"></i> {{ project.name }} </h3>
      </div>
      <div class="panel-body">
        <div id="morris-chart-area"></div>
      </div>
        <a href="/college/report/{{ project.p_id }}">
          <div class="panel-footer announcement-bottom">
            <div class="row">
              <div class="col-xs-6">
                View detailed report
              </div>
              <div class="col-xs-6 text-right">
                <i class="fa fa-arrow-circle-right"></i>
              </div>
            </div>
          </div>
        </a>
        {% if not student %}
        <a href="/college/teacher/evaluate/{{ project.p_id }}">
          <div class="panel-footer announcement-bottom">
            <div class="row">
              <div class="col-xs-6">
                Evaluate project
              </div>
              <div class="col-xs-6 text-right">
                <i class="fa fa-arrow-circle-right"></i>
              </div>
            </div>
          </div>
        </a>
        {% endif %}
      </div>
    </div>
  </div>
</div><!-- /.row -->

{% if student %}

<h3>File upload</h3>
<p> The project should be uploaded in .zip format </p>
<hr/>


<div>

<form method="post" action="/college/student/upload/{{ project.p_id }}/" enctype="multipart/form-data">
  {% csrf_token %}
<input type="file" name="upload"/>
<input type="submit">
</form>

</div>

{% else %}

<h3>Uploaded files</h3>
<hr/>

<a href="/college/teacher/download/{{ project.p_id }}/">{{ project.file.name }}</a>

{% endif %}

<h3>Comments</h3>
<hr/>

<div class="container" style="width: 800px;">
  {% set_disqus_identifier "pid_" project.p_id %}
  {% disqus_show_comments %}

</div>
{% endblock %}

{% block javascript %}

{{ block.super }}

{% if evals %}
    <script type="text/javascript">

      Morris.Area({
        // ID of the element in which to draw the chart.
        element: 'morris-chart-area',
        // Chart data records -- each entry in this array corresponds to a point on
        // the chart.
        data: [

          {% for e in evals %}
            {d: '{{ e.timestamp.date.isoformat }}', scores: {{ e.score }} },
          {% endfor %}

        ],
        // The name of the data record attribute that contains x-visitss.
        xkey: 'd',
        // A list of names of data record attributes that contain y-visitss.
        ykeys: ['scores'],
        // Labels for the ykeys -- will be displayed when you hover over the
        // chart.
        labels: ['Score'],
        // Disables line smoothing
        smooth: false,
      });

      {% for e in evals %}
      Morris.Donut({
        element: 'morris-chart-donut-{{ e.id }}',
        data: [

          {label: "Submission", value: {{ e.submission }}},
          {label: "Quality", value: {{ e.quality }}},
          {label: "Research", value: {{ e.research }}},
          {label: "Presentation", value: {{ e.presentation }}},
          {label: "Output", value: {{ e.output }}}
        ],
        formatter: function (y) { return y + "%" ;}
      });
      {% endfor %}

    </script>
    {% endif %}
{% endblock %}

{% block page_specific %}
{% endblock %}